<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>
<!DOCTYPE doc SYSTEM "../../clonk.dtd">
<?xml-stylesheet type="text/xsl" href="../../clonk.xsl"?>
<doc>
<title>Partikel</title>

<h id="Partikel">Partikel</h>
<part>
	<text>Partikel sind abgespeckte Objekte, die im Netzwerk nicht synchronisationsrelevant sind. Das heißt einerseits, dass man Partikel relativ problemlos in größeren Mengen erstellen kann, um interessante Effekte zu erzielen. Andererseits existieren nur sehr wenige Möglichkeiten, un das Verhalten von Partikeln zu steuern. Wenn die Möglichkeiten von Partikeln also für einen Effekt nicht ausreichen, sollten stattdessen reguläre Objekte verwenden, mit denen sich alle durch Partikel darstellbaren Effekte auch erzielen lassen.</text>
	<text>Wenn ein Partikel in einer c4d-Datei definiert ist, wird ein ebenfalls in dieser Gruppendatei vorhandenes Objekt nicht geladen. Im veralteten Grafiksystem konnte man so ein alternatives Objekt anbieten, das im neuen Grafiksystem nicht geladen wird.</text>
	<text>Partikel werden nicht in Spielständen gespeichert, da sie nur für kurzzeitige Effekte gedacht sind.</text>
	
	<h id="PartikelKomponentenC4D">Partikel-Komponenten (C4D)</h>
	<dl>
		<dt><img src="../../images/icon_text.gif" width="16" height="16"/>Particle.txt</dt>
		<dd>
			<text>Partikeleigenschaften.</text>
		</dd>

		<dt id="Graphicspng"><img src="../../images/icon_image.gif" width="16" height="16"/>Graphics.png</dt>
		<dd>
			<text>Partikelgrafik.</text>
			<text>Zusätzlich dazu sind natürlich auch alle von <emlink href="definition/index.html">Objektdefinitionen</emlink> bekannten Elemente für das Frontend verfügbar (also z.B. Title.bmp, DescDE/US.txt, etc.)</text>
		</dd>
	</dl>
	
	<h id="Particletxt">Particle.txt</h>
	<text>In dieser Datei werden - analog zur <emlink href="definition/defcore.html">DefCore.txt</emlink> bei <emlink href="definition/index.html">Objektdefinitionen</emlink> - die Eigenschaften des Partikeltyps beschrieben.</text>
	<text><table>
		<caption id="SektionDefCore">Sektion [Particle]</caption>
		<rowh>
			<col>Wert</col><col>Datentyp</col><col>Beschreibung</col>
		</rowh>
		<row>
			<col>Name</col><col>Zeichenfolge (max. 30)</col>
			<col>Name des Partikeltyps. Dieser Name dient zugleich zur Referenzierung in Scripten. Für Mehrsprachigkeit im Frontend sollte die Names.txt benutzt werden.</col>
		</row>
		<row>
			<col>MaxCount</col>
			<col>Integer</col>
			<col>Maximale Instanzzahl für diesen Partikeltyp. Siehe <a href="#maxcount">Mengenkontrolle</a>.</col>
		</row>
		<row>
			<col>MinLifetime</col>
			<col>Integer</col>
			<col>Nur für Rauchpartikel: Untere Grenze für die Lebensdauer, die nach Zufall zwischen MinLifetime und MaxLifetime gesetzt wird.</col>
		</row>
		<row>
			<col>MaxLifetime</col>
			<col>Integer</col>
			<col>Nur für Rauchpartikel: Obere Grenze für die Lebensdauer, die nach Zufall zwischen MinLifetime und MaxLifetime gesetzt wird.</col>
		</row>
		<row>
			<col>InitFn</col>
			<col>Zeichenfolge (max. 30)</col>
			<col>Identifikator für die Funktion, die zur Initialisierung des Partikels verwendet wird. Für gültige Funktionen siehe Sektion <a href="#funcs">Partikelfunktionen</a>.</col>
		</row>
		<row>
			<col>ExecFn</col>
			<col>Zeichenfolge (max. 30)</col>
			<col>Identifikator für die Funktion, die jedes Frame zur Ausführung des Partikels verwendet wird. Für gültige Funktionen siehe Sektion <a href="#funcs">Partikelfunktionen</a>.</col>
		</row>
		<row>
			<col>DrawFn</col>
			<col>Zeichenfolge (max. 30)</col>
			<col>Identifikator für die Funktion, die zum Zeichnen des Partikels verwendet wird. Für gültige Funktionen siehe Sektion <a href="#drawfuncs">Zeichenfunktionen</a>.</col>
		</row>
		<row>
			<col>CollisionFn</col>
			<col>Zeichenfolge (max. 30)</col>
			<col>Identifikator für die Funktion, die Kollision des Partikels mit der Landschaft aufgerufen wird. Siehe auch <a href="#collision">Kollisionsabfrage</a></col>
		</row>
		<row>
			<col>Face</col>
			<col>6 Integer</col>
			<col>Zielrechteck für die Grafik in der Graphics.png. Siehe <a href="#face">Partikelgrafik</a>.</col>
		</row>
		<row>
			<col>YOff</col>
			<col>Integer</col>
			<col>Obere Grenze für diesen Partikeltyp. An dieser Stelle werden die Partikel abgeschnitten, als wäre die Landschaft schon dort zu Ende. Nur StdExec.</col>
		</row>
		<row>
			<col>Delay</col>
			<col>Integer</col>
			<col>Wartezeit zwischen den Animationsphasen. Bei Delay=0 wird eine Zufallsphase dauerhaft benutzt.</col>
		</row>
		<row>
			<col>Repeats</col>
			<col>Integer</col>
			<col>Anzahl der Animationswiederholungen, bis sich das Partikel zerstört.</col>
		</row>
		<row>
			<col>Reverse</col>
			<col>Integer</col>
			<col>0 oder 1. Bei 1 wird jede zweite Animation rückwärts abgespielt.</col>
		</row>
		<row>
			<col>FadeOutLen</col>
			<col>Integer</col>
			<col>Falls angegeben, wird diese Anzahl der Animationsphasen von hinten abgenommen und für eine Endanimation reserviert, die nach Repeats Abläufen der Standardanimation ausgeführt wird.</col>
		</row>
		<row>
			<col>FadeOutDelay</col>
			<col>Integer</col>
			<col>Wartezeit zwischen zwei in FadeOutLen angegebenen Animationsphasen.</col>
		</row>
		<row>
			<col>RByV</col>
			<col>Integer</col>
			<col>0 bis 3. 0 für keine Partikel-Drehung. Bei 1 dreht sich das Partikel nach Bewegungsrichtung; vorne ist dabei oben. Bei 2 dienen die Geschwindigkeitparameter nur der Ausrichtung; das Partikel bewegt sich nicht. Bei 3 dreht sich das Partikel zufällig (ab 4.9.8.0).</col>
		</row>
		<row>
			<col>GravityAcc</col>
			<col>Integer</col>
			<col>Gravitationsauswirkung. Bei 0 wird das Partikel gar nicht von der Gravitation beschleunigt, bei 100 normal. Negative Werte sind ebenfalls möglich.</col>
		</row>
		<row>
			<col>WindDrift</col>
			<col>Integer</col>
			<col>Abtrieb durch Wind. Wie die gleichnamige Materialeigenschaft. Ab CR 4.9.8.4.</col>
		</row>
		<row>
			<col>VertexCount</col>
			<col>Integer</col>
			<col>0 oder 1. Bei 1 wird eine <a href="#collision">Kollisionsabfrage</a> durchgeführt.</col>
		</row>
		<row>
			<col>VertexY</col>
			<col>Integer</col>
			<col>Prozentualer Wert fürs Y-Offset des Abfragepunktes für Kollisionen mit der Landschaft. Siehe auch <a href="#collision">Kollisionsabfrage</a>.</col>
		</row>
		<row>
			<col>Additive</col>
			<col>Integer</col><col>0 oder 1. Bei 1 wird das Partikel additiv gezeichnet.</col>
		</row>
		<row>
			<col>AlphaFade</col>
			<col>Integer</col>
			<col>0 bis 40. Ausfaden pro FadeDelay. Wenn das Partikel vollends ausgefadet ist, verschwindet es.</col>
		</row>
		<row>
			<col>FadeDelay</col>
			<col>Integer</col>
			<col>Default ist 1.</col>
		</row>
		<row>
			<col>Parallaxity</col>
			<col>2 Integer</col>
			<col>Parallaxität in X- und in Y-Richtung. 0 ist fest mit dem Bildschirm; 100 ist Standard (fest mit der Landschaft).</col>
		</row>
		<row>
			<col>Attach</col>
			<col>Integer</col>
			<col>0 oder 1. Bei 1 bewegt sich das Partikel bei angegebenem Zielobjekt relativ zu diesem. Ab 4.95.4.</col>
		</row>
	</table></text>
	
	<h id="attributes">Eigenschaften</h>
	<text>Jedes Partikel hat eine Position (x, y), Impulse horizontal (xdir) und vertikal (ydir), sowie eine Lebenszeit (life) und zwei Extraparameter (a und b). Diese werden von den <a href="#funcs">Partikelfunktionen</a> verwaltet, und können bei der Erzeugung im Script nur mit Startwerten versehen werden. Für die Bedeutung der Attribute im Einzelnen siehe <a href="#funcs">Partikelfunktionen</a> und <a href="#drawfuncs">Zeichenfunktionen</a>.</text>
	
	<h id="face">Grafik</h>
	<text>Die Koordinaten für das Zielrechteck der Grafik in die Graphics.png sind vergleichbar mit Face in der <emlink href="definition/actmap.html">ActMap.txt</emlink>. Die geben nur die erste Animationsphase an, und alle weiteren Phasen sollten rechts (Bei Rauch auch unterhalb) davon liegen; die Animationslänge wird automatisch aus der Größe der Grafik ermittelt. Für das Grafikoffset sollte normalerweise die halbe Objektgröße angegeben werden, da das Standardoffset 0/0 bedeuten würde, dass das die Grafik rechts unterhalb der eigentlichen Partikelposition gezeichnet wird.</text>
	<text>Wenn für Delay 0 angegeben ist, wird bei der Initialisierung eine zufällige Animationsphase ausgesucht, und beibehalten. Das Partikel existiert dann, bis es aus der Landschaft geflogen ist.</text>
	
	<h id="maxcount">Mengenkontrolle</h>
	<text>Für jedes Partikel wird eine Maximalzahl angegeben, die nach der vom Spieler in den Grafikoptionen angegebene Effektmenge noch angepasst werden kann. Sobald mehr als die Hälfte dieser Anzahl vorhanden ist, werden schon nach dem Zufallsprinzip einige Partikel nicht erstellt, so dass die Zahl der neu erzeugten Partikel mit Zunahme zur Maximalmenge schrumpft, und der übergang nicht zu hart ist, wenn die Partikelmenge an ihre Grenzen stößt. Wenn es wichtig ist, dass ein Partikel garantiert erzeugt wird, sollte in jedem Fall stattdessen ein Objekt benutzt werden, da Partikel auch nach dem Speichern verschwinden.</text>
	
	<h id="collision">Kollisionsabfrage</h>
	<text>Partikel können Kollisionsabfragen mit der Landschaft durchführen. Diese sind jedoch nicht sehr genau; schnelle Partikel können also durch dünne Materialschichten hindurchfliegen. Wenn das nicht akzeptabel ist, müssen Objekte benutzt werden.</text>
	<text>Kollisionsabfragen werden nur bei StdExec durchgeführt, also nicht bei Rauchpartikeln. Für gültige Funktionen siehe Sektion <a href="#funcs">Partikelfunktionen</a>. Die Abfrage wird nur bei angegebenem VertexCount und an der Objektmitte durchgeführt. Der Abfragepunkt kann vertikal mit VertexY verschoben werden. Die angegebenen Koordinaten sind dabei prozentual zur Partikelgröße, das heißt VertexY=100 würde am unteren Rand des Partikels prüfen. Die in Face angegebene Größe der eigentlichen Grafik spielt dabei keine Rolle.</text>
	
	<h id="funcs">Partikelfunktionen</h>
	<text>Das Verhalten von Partikeln kann durch Angabe von Partikelfunktionen gesteuert werden. Diese werden zur Initialisierung, jedes Frame und bei <a href="#collision">Kollision</a> mit der Landschaft ausgeführt.</text>

	<dl>
		<dt id="stdexec">StdExec</dt>
		<dd><text>Standardfunktion für ExecFn für fast alle Partikel. Das Partikel führt eine durch Face, Delay, Repeats, Reverse, FadeOutLen und FadeOutDelay definierte Animation aus, und wird dann zerstört. Dabei steht der Extraparameter a für die Größe der Grafik in Zehntelpixeln. b gibt eine Farbmodulation an; bei b=0 wird gar nicht moduliert. Sowohl aa als auch b werden von dieser Funktion nicht verändert und behalten somit ihre bei der <a href="#control">Erschaffung</a> angegebenen Werte. Ferner bewegt sich das Partikel nach xdir und ydir, wobei sich ydir bei angegebenem GravityAcc je nach Gravitation erhöhen oder verringern kann.</text></dd>
		
		<dt id="stdinit">StdInit</dt>
		<dd><text>Standardfunktion, die für InitFn zusammen mit StdExec verwendet werden sollte.</text></dd>
		
		<dt id="bounce">Bounce</dt>
		<dd><text>Kollisionsfunktion: Das Partikel kehrt seine Richtung komplett um.</text></dd>
		
		<dt id="bouncey">BounceY</dt>
		<dd><text>Kollisionsfunktion: Das Partikel kehrt nur die vertikale Geschwindigkeit um.</text></dd>
		
		<dt id="stop">Stop</dt>
		<dd><text>Kollisionsfunktion: Das Partikel hält an.</text></dd>
		
		<dt id="die">Die</dt>
		<dd><text>Kollisionsfunktion: Das Partikel wird sofort zerstört.</text></dd>
		
		<dt id="smokeexec">SmokeExec</dt>
		<dd><text>Hardgecodete Lösung für ExecFn für Rauch. a ist wieder die Rauchgröße; b die Farbmodulation. Der Rauch muss 4x4 Grafiken in der Graphics.png definiert haben, von denen die unterste rechte nur sehr selten benutzt wird. Die anderen werden gleichmäßig ausgewählt. Der Rauch steigt immer gleichmäßig auf und hält an, wenn er mit der Oberkante die Landschaft kollidiert. Wenn die Lebenszeit life abgelaufen ist, fadet der Rauch aus, in dem sich die Alphakomponente von b erhöht, bis sie 255 ist und das Partikel entfernt wird.</text></dd>
		
		<dt id="smokeinit">SmokeInit</dt>
		<dd><text>Funktion für InitFn, die zusammen mit ExecFn=SmokeExec benutzt werden sollte.</text></dd>
	</dl>
	
	<h id="drawfuncs">Zeichenfunktionen</h>
	<text>Funktionen, die DrawFn zugewiesen werden können.</text>
		
	<dl>
		<dt id="drawstd">Std</dt>
		<dd><text>Standardfunktion für fast alle Fälle außer Rauch. Das Partikel wird an x/y in der Größe a/5 x a/5 gezeichnet, und mit b farbmoduliert.</text></dd>
		
		<dt id="drawsmoke">Smoke</dt>
		<dd><text>Zeichenfunktion für Rauch. Sollte zusammen mit SmokeInit und SmokeExec verwendet werden.</text></dd>
	</dl>
	
	<h id="control">Kontrolle</h>
	<text>Die externe Kontrolle von Partikeln beschränkt sich auf wenige Funktionen zur Erzeugung, Gesamtverschiebung und Gesamtzerstörung. Das muss so sein, da Partikel nicht syncrelevant sind, und damit so gut wie gar nicht vom Script aus abfragbar sein können (ansonsten würden unterschiedliche Effektmengen im Netzwerk zu Desyncs führen). Partikel werden mit <funclink>CreateParticle</funclink> erschaffen.</text>
</part>

<author>Sven2</author><date>April 2002</date>

</doc>
